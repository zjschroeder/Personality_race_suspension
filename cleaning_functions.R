# Functions for data cleaning

####################  Pomp Scoring
pomp <- function(score) {
  score_p  <- (score - min(score, na.rm = T)) / (max(score, na.rm = T) - min(score, na.rm = T)) 
  #IF ERRROR: May need to na.rm = T
  return (10 * score_p)
}

# example
# data <- rnorm(100, mean = 50, sd = 1)
# pomp(data)


#################### Complete Cases
completeFun <- function(data, desiredCols) {
  completeVec <- complete.cases(data[, desiredCols])
  return(data[completeVec, ])
}


#################### Scrambled Data Function

## > The scramble() function is meant to be applied to a single vector (or variable). 
## To apply to an entire dataset, consider the use of a loop or, better yet, tidyverse (included at top of chunk)
## scrambled_data = data 
## %>% mutate(across(everything(), scramble))


scramble_chr = function(x, retain_missing = retain_missing){
  where_miss = which(is.na(x))
  unique_vals = table(x)
  new_x = sample(names(unique_vals),
                 replace = T,
                 size = length(x),
                 prob = unique_vals/sum(unique_vals))
  if(retain_missing){
    new_x[where_miss] = NA
  } else {
    new_x[sample(1:length(x), size = length(where_miss))] = NA
  }
  #check if all numbers, then make numeric
  if(is.numeric(x)) if(sum(grepl("[[:alpha:]]", new_x)) == 0) new_x = as.integer(new_x)
  return(new_x)
}

scramble_num = function(x, retain_missing = retain_missing){
  where_miss = which(is.na(x))
  mx = mean(x, na.rm=T)
  sx = sd(x, na.rm=T)
  rx = range(x, na.rm=T)
  new_x = rnorm(n = length(x),
                mean = mx,
                sd = sx)
  if(retain_missing){
    new_x[where_miss] = NA
  } else {
    new_x[sample(1:length(x), size = length(where_miss))] = NA
  }
  while(min(new_x, na.rm=T) < rx[1]){
    new_x[new_x == min(new_x, na.rm=T)] = rnorm(1, mean = mx, sd = sx)
  }
  while(max(new_x, na.rm=T) > rx[2]){
    new_x[new_x == max(new_x, na.rm=T)] = rnorm(1, mean = mx, sd = sx)
  }
  return(new_x)
}

scramble = function(x, retain_missing = T){
  n_na = sum(is.na(x))
  if(n_na != length(x)){
    if(is.character(x) | is.factor(x)){
      scramble_chr(x, retain_missing = retain_missing)
    } else {
      if(is.logical(all.equal(x, as.integer(x)))){
        scramble_chr(x, retain_missing = retain_missing)
      } else {
        scramble_num(x, retain_missing = retain_missing)
      }
    }
  } else {
    new_x = x
    return(new_x)}
}


# # test vectors ------------------------------------------------------------
# test1 = sample(c("dog", "cat", "fish", NA), size = 200, replace = T)
# test1_s = scramble(test1)
# table(test1)
# table(test1_s)
# 
# test2 = rbinom(n = 200, size = 7, prob = .5)
# test2_s = scramble(test2)
# table(test2)
# table(test2_s)
# 
# test3 = rnorm(200, m = 5)
# test3[sample(1:200, size = 20)] = NA
# test3_s = scramble(test3)
# mean(test3, na.rm=T); sd(test3, na.rm=T)
# mean(test3_s, na.rm=T); sd(test3_s, na.rm=T)
# cor(test3, test3_s, use = "pairwise")
# 
# library(psychTools)
# data("tai") # has a mix of factor and numeric variables
# 
# library(tidyverse) # for the useful mutate function
# 
# tai_s = tai %>%
# mutate(across(.cols = everything(), scramble)) #give me a scrambled dataset


vallabels = function(data) {
  data$C0000100[1.0 <= data$C0000100 & data$C0000100 <= 9999999.0] <- 1.0
  data$C0000100 <- factor(data$C0000100, 
                          levels=c(1.0), 
                          labels=c("1 TO 9999999: See Min & Max values below for range as of this release"))
  data$C0000200[1.0 <= data$C0000200 & data$C0000200 <= 12686.0] <- 1.0
  data$C0000200 <- factor(data$C0000200, 
                          levels=c(1.0), 
                          labels=c("1 TO 12686: NLSY79 Public ID"))
  data$C0005300 <- factor(data$C0005300, 
                          levels=c(1.0,2.0,3.0), 
                          labels=c("HISPANIC",
                                   "BLACK",
                                   "NON-BLACK, NON-HISPANIC"))
  data$C0005400 <- factor(data$C0005400, 
                          levels=c(1.0,2.0), 
                          labels=c("MALE",
                                   "FEMALE"))
  data$C0005500 <- factor(data$C0005500, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0), 
                          labels=c("1: JANUARY",
                                   "2: FEBRUARY",
                                   "3: MARCH",
                                   "4: APRIL",
                                   "5: MAY",
                                   "6: JUNE",
                                   "7: JULY",
                                   "8: AUGUST",
                                   "9: SEPTEMBER",
                                   "10: OCTOBER",
                                   "11: NOVEMBER",
                                   "12: DECEMBER"))
  data$C0005700[1970.0 <= data$C0005700 & data$C0005700 <= 1978.0] <- 1970.0
  data$C0005700 <- factor(data$C0005700, 
                          levels=c(1970.0,1979.0,1980.0,1981.0,1982.0,1983.0,1984.0,1985.0,1986.0,1987.0,1988.0,1989.0,1990.0,1991.0,1992.0,1993.0,1994.0,1995.0,1996.0,1997.0,1998.0,1999.0,2000.0,2001.0,2002.0,2003.0,2004.0,2005.0,2006.0,2007.0,2008.0,2009.0,2010.0,2011.0,2012.0,2013.0,2014.0,2015.0,2016.0,2017.0,2018.0,2019.0), 
                          labels=c("1970 TO 1978: < before 1979",
                                   "1979",
                                   "1980",
                                   "1981",
                                   "1982",
                                   "1983",
                                   "1984",
                                   "1985",
                                   "1986",
                                   "1987",
                                   "1988",
                                   "1989",
                                   "1990",
                                   "1991",
                                   "1992",
                                   "1993",
                                   "1994",
                                   "1995",
                                   "1996",
                                   "1997",
                                   "1998",
                                   "1999",
                                   "2000",
                                   "2001",
                                   "2002",
                                   "2003",
                                   "2004",
                                   "2005",
                                   "2006",
                                   "2007",
                                   "2008",
                                   "2009",
                                   "2010",
                                   "2011",
                                   "2012",
                                   "2013",
                                   "2014",
                                   "2015",
                                   "2016",
                                   "2017",
                                   "2018",
                                   "2019"))
  data$C0785700 <- factor(data$C0785700, 
                          levels=c(0.0,1.0), 
                          labels=c("NO",
                                   "YES"))
  data$C0785800[17.0 <= data$C0785800 & data$C0785800 <= 99999.0] <- 17.0
  data$C0785800 <- factor(data$C0785800, 
                          levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0), 
                          labels=c("0: < 1",
                                   "1",
                                   "2",
                                   "3",
                                   "4",
                                   "5",
                                   "6",
                                   "7",
                                   "8",
                                   "9",
                                   "10",
                                   "11",
                                   "12",
                                   "13",
                                   "14",
                                   "15",
                                   "16",
                                   "17 TO 99999: 17+"))
  data$C0988400 <- factor(data$C0988400, 
                          levels=c(0.0,1.0), 
                          labels=c("NO",
                                   "YES"))
  data$C0988500[17.0 <= data$C0988500 & data$C0988500 <= 99999.0] <- 17.0
  data$C0988500 <- factor(data$C0988500, 
                          levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0), 
                          labels=c("0: < 1",
                                   "1",
                                   "2",
                                   "3",
                                   "4",
                                   "5",
                                   "6",
                                   "7",
                                   "8",
                                   "9",
                                   "10",
                                   "11",
                                   "12",
                                   "13",
                                   "14",
                                   "15",
                                   "16",
                                   "17 TO 99999: 17+"))
  data$C1186700 <- factor(data$C1186700, 
                          levels=c(0.0,1.0), 
                          labels=c("NO",
                                   "YES"))
  data$C1186800[17.0 <= data$C1186800 & data$C1186800 <= 99999.0] <- 17.0
  data$C1186800 <- factor(data$C1186800, 
                          levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0), 
                          labels=c("0: < 1",
                                   "1",
                                   "2",
                                   "3",
                                   "4",
                                   "5",
                                   "6",
                                   "7",
                                   "8",
                                   "9",
                                   "10",
                                   "11",
                                   "12",
                                   "13",
                                   "14",
                                   "15",
                                   "16",
                                   "17 TO 99999: 17+"))
  data$C1440400 <- factor(data$C1440400, 
                          levels=c(0.0,1.0), 
                          labels=c("NO",
                                   "YES"))
  data$C1440500[16.0 <= data$C1440500 & data$C1440500 <= 99999.0] <- 16.0
  data$C1440500 <- factor(data$C1440500, 
                          levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0), 
                          labels=c("0",
                                   "1",
                                   "2",
                                   "3",
                                   "4",
                                   "5",
                                   "6",
                                   "7",
                                   "8",
                                   "9",
                                   "10",
                                   "11",
                                   "12",
                                   "13",
                                   "14",
                                   "15",
                                   "16 TO 99999: 16+"))
  data$C1642800 <- factor(data$C1642800, 
                          levels=c(0.0,1.0), 
                          labels=c("No",
                                   "Yes"))
  data$C1642900 <- factor(data$C1642900, 
                          levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,95.0), 
                          labels=c("0: KINDERGARTEN",
                                   "1: 1ST GRADE",
                                   "2: 2ND GRADE",
                                   "3: 3RD GRADE",
                                   "4: 4TH GRADE",
                                   "5: 5TH GRADE",
                                   "6: 6TH GRADE",
                                   "7: 7TH GRADE",
                                   "8: 8TH GRADE",
                                   "9: 9TH GRADE",
                                   "10: 10TH GRADE",
                                   "11: 11TH GRADE",
                                   "12: 12TH GRADE",
                                   "95: DOES NOT APPLY"))
  data$C1983200 <- factor(data$C1983200, 
                          levels=c(0.0,1.0), 
                          labels=c("No",
                                   "Yes"))
  data$C1983300 <- factor(data$C1983300, 
                          levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,95.0), 
                          labels=c("0: KINDERGARTEN",
                                   "1: 1ST GRADE",
                                   "2: 2ND GRADE",
                                   "3: 3RD GRADE",
                                   "4: 4TH GRADE",
                                   "5: 5TH GRADE",
                                   "6: 6TH GRADE",
                                   "7: 7TH GRADE",
                                   "8: 8TH GRADE",
                                   "9: 9TH GRADE",
                                   "10: 10TH GRADE",
                                   "11: 11TH GRADE",
                                   "12: 12TH GRADE",
                                   "95: DOES NOT APPLY"))
  data$C2251400 <- factor(data$C2251400, 
                          levels=c(0.0,1.0), 
                          labels=c("No",
                                   "Yes"))
  data$C2251500 <- factor(data$C2251500, 
                          levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,90.0), 
                          labels=c("KINDERGARTEN",
                                   "1ST GRADE",
                                   "2ND GRADE",
                                   "3RD GRADE",
                                   "4TH GRADE",
                                   "5TH GRADE",
                                   "6TH GRADE",
                                   "7TH GRADE",
                                   "8TH GRADE",
                                   "9TH GRADE",
                                   "10TH GRADE",
                                   "11TH GRADE",
                                   "12TH GRADE",
                                   "NURSERY/PRESCHOOL"))
  data$C2735000 <- factor(data$C2735000, 
                          levels=c(0.0,1.0), 
                          labels=c("No",
                                   "Yes"))
  data$C2735100 <- factor(data$C2735100, 
                          levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,90.0), 
                          labels=c("KINDERGARTEN",
                                   "1ST GRADE",
                                   "2ND GRADE",
                                   "3RD GRADE",
                                   "4TH GRADE",
                                   "5TH GRADE",
                                   "6TH GRADE",
                                   "7TH GRADE",
                                   "8TH GRADE",
                                   "9TH GRADE",
                                   "10TH GRADE",
                                   "11TH GRADE",
                                   "12TH GRADE",
                                   "NURSERY/PRESCHOOL"))
  data$C3007400 <- factor(data$C3007400, 
                          levels=c(0.0,1.0), 
                          labels=c("No",
                                   "Yes"))
  data$C3007500 <- factor(data$C3007500, 
                          levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,90.0), 
                          labels=c("KINDERGARTEN",
                                   "1ST GRADE",
                                   "2ND GRADE",
                                   "3RD GRADE",
                                   "4TH GRADE",
                                   "5TH GRADE",
                                   "6TH GRADE",
                                   "7TH GRADE",
                                   "8TH GRADE",
                                   "9TH GRADE",
                                   "10TH GRADE",
                                   "11TH GRADE",
                                   "12TH GRADE",
                                   "NURSERY/PRESCHOOL"))
  data$C3577600 <- factor(data$C3577600, 
                          levels=c(0.0,1.0), 
                          labels=c("No",
                                   "Yes"))
  data$C3577700 <- factor(data$C3577700, 
                          levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,90.0), 
                          labels=c("KINDERGARTEN",
                                   "1ST GRADE",
                                   "2ND GRADE",
                                   "3RD GRADE",
                                   "4TH GRADE",
                                   "5TH GRADE",
                                   "6TH GRADE",
                                   "7TH GRADE",
                                   "8TH GRADE",
                                   "9TH GRADE",
                                   "10TH GRADE",
                                   "11TH GRADE",
                                   "12TH GRADE",
                                   "NURSERY/PRESCHOOL"))
  data$C3950100 <- factor(data$C3950100, 
                          levels=c(0.0,1.0), 
                          labels=c("No",
                                   "Yes"))
  data$C3950200 <- factor(data$C3950200, 
                          levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,90.0), 
                          labels=c("KINDERGARTEN",
                                   "1ST GRADE",
                                   "2ND GRADE",
                                   "3RD GRADE",
                                   "4TH GRADE",
                                   "5TH GRADE",
                                   "6TH GRADE",
                                   "7TH GRADE",
                                   "8TH GRADE",
                                   "9TH GRADE",
                                   "10TH GRADE",
                                   "11TH GRADE",
                                   "12TH GRADE",
                                   "NURSERY/PRESCHOOL"))
  data$C5194200 <- factor(data$C5194200, 
                          levels=c(0.0,1.0), 
                          labels=c("No",
                                   "Yes"))
  data$C5194300 <- factor(data$C5194300, 
                          levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,90.0), 
                          labels=c("KINDERGARTEN",
                                   "1ST GRADE",
                                   "2ND GRADE",
                                   "3RD GRADE",
                                   "4TH GRADE",
                                   "5TH GRADE",
                                   "6TH GRADE",
                                   "7TH GRADE",
                                   "8TH GRADE",
                                   "9TH GRADE",
                                   "10TH GRADE",
                                   "11TH GRADE",
                                   "12TH GRADE",
                                   "NURSERY/PRESCHOOL"))
  data$C5769100 <- factor(data$C5769100, 
                          levels=c(0.0,1.0), 
                          labels=c("No",
                                   "Yes"))
  data$C5769200 <- factor(data$C5769200, 
                          levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,90.0), 
                          labels=c("KINDERGARTEN",
                                   "1ST GRADE",
                                   "2ND GRADE",
                                   "3RD GRADE",
                                   "4TH GRADE",
                                   "5TH GRADE",
                                   "6TH GRADE",
                                   "7TH GRADE",
                                   "8TH GRADE",
                                   "9TH GRADE",
                                   "10TH GRADE",
                                   "11TH GRADE",
                                   "12TH GRADE",
                                   "NURSERY/PRESCHOOL"))
  data$C6035900 <- factor(data$C6035900, 
                          levels=c(0.0,1.0), 
                          labels=c("No",
                                   "Yes"))
  data$C6036000 <- factor(data$C6036000, 
                          levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,90.0), 
                          labels=c("KINDERGARTEN",
                                   "1ST GRADE",
                                   "2ND GRADE",
                                   "3RD GRADE",
                                   "4TH GRADE",
                                   "5TH GRADE",
                                   "6TH GRADE",
                                   "7TH GRADE",
                                   "8TH GRADE",
                                   "9TH GRADE",
                                   "10TH GRADE",
                                   "11TH GRADE",
                                   "12TH GRADE",
                                   "NURSERY/PRESCHOOL"))
  data$Y0307300 <- factor(data$Y0307300, 
                          levels=c(0.0,1.0), 
                          labels=c("CONDITION DOES NOT APPLY",
                                   "CONDITION APPLIES"))
  data$Y0367000 <- factor(data$Y0367000, 
                          levels=c(1.0,2.0,3.0,4.0), 
                          labels=c("1: NEVER",
                                   "2: ONCE IN A WHILE",
                                   "3: FAIRLY OFTEN",
                                   "4: VERY OFTEN"))
  data$Y0661000 <- factor(data$Y0661000, 
                          levels=c(1.0,2.0,3.0,4.0), 
                          labels=c("1: NEVER",
                                   "2: ONCE IN A WHILE",
                                   "3: FAIRLY OFTEN",
                                   "4: VERY OFTEN"))
  data$Y0957900 <- factor(data$Y0957900, 
                          levels=c(1.0,2.0,3.0,4.0), 
                          labels=c("NEVER",
                                   "ONCE IN A WHILE",
                                   "FAIRLY OFTEN",
                                   "VERY OFTEN"))
  data$Y1921300 <- factor(data$Y1921300, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y1921301 <- factor(data$Y1921301, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y1921302 <- factor(data$Y1921302, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y1921303 <- factor(data$Y1921303, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y1921304 <- factor(data$Y1921304, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y1921305 <- factor(data$Y1921305, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y1921306 <- factor(data$Y1921306, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y1921307 <- factor(data$Y1921307, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y1921308 <- factor(data$Y1921308, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y1921309 <- factor(data$Y1921309, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y2238200 <- factor(data$Y2238200, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y2238201 <- factor(data$Y2238201, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y2238202 <- factor(data$Y2238202, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y2238203 <- factor(data$Y2238203, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y2238204 <- factor(data$Y2238204, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y2238205 <- factor(data$Y2238205, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y2238206 <- factor(data$Y2238206, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y2238207 <- factor(data$Y2238207, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y2238208 <- factor(data$Y2238208, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y2238209 <- factor(data$Y2238209, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y2267000 <- factor(data$Y2267000, 
                          levels=c(506.0), 
                          labels=c("506"))
  data$Y2590300 <- factor(data$Y2590300, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y2590301 <- factor(data$Y2590301, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y2590302 <- factor(data$Y2590302, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y2590303 <- factor(data$Y2590303, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y2590304 <- factor(data$Y2590304, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y2590305 <- factor(data$Y2590305, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y2590306 <- factor(data$Y2590306, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y2590307 <- factor(data$Y2590307, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y2590308 <- factor(data$Y2590308, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y2590309 <- factor(data$Y2590309, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y2937100 <- factor(data$Y2937100, 
                          levels=c(0.0,1.0), 
                          labels=c("0: CONDITION DOES NOT APPLY",
                                   "1: CONDITION APPLIES"))
  data$Y2937200 <- factor(data$Y2937200, 
                          levels=c(0.0,1.0), 
                          labels=c("0: NA FOR SECOND RANDOMIZATION",
                                   "1: SELECTED FOR SECOND RANDOMIZATION"))
  data$Y2937300 <- factor(data$Y2937300, 
                          levels=c(0.0,1.0), 
                          labels=c("0: NA TO COMPLETE BOTH TIPI AND MINI-IPIP",
                                   "1: SELECTED TO COMPLETE BOTH TIPI AND MINI-IPIP"))
  data$Y2937400 <- factor(data$Y2937400, 
                          levels=c(0.0,1.0), 
                          labels=c("0: NA FOR SECOND RANDOMIZATION",
                                   "1: SELECTED FOR SECOND RANDOMIZATION"))
  data$Y2937500 <- factor(data$Y2937500, 
                          levels=c(0.0,1.0), 
                          labels=c("0: NA TO COMPLETE BOTH TIPI AND MINI-IPIP",
                                   "1: SELECTED TO COMPLETE BOTH TIPI AND MINI-IPIP"))
  data$Y2937600 <- factor(data$Y2937600, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y2937601 <- factor(data$Y2937601, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y2937602 <- factor(data$Y2937602, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y2937603 <- factor(data$Y2937603, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y2937604 <- factor(data$Y2937604, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y2937605 <- factor(data$Y2937605, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y2937606 <- factor(data$Y2937606, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y2937607 <- factor(data$Y2937607, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y2937608 <- factor(data$Y2937608, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y2937609 <- factor(data$Y2937609, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y2937800 <- factor(data$Y2937800, 
                          levels=c(1.0,2.0,3.0,4.0,5.0), 
                          labels=c("Very Inaccurate",
                                   "Moderately Inaccurate",
                                   "Neither Accurate Nor Inaccurate",
                                   "Moderately Accurate",
                                   "Very Accurate"))
  data$Y2937801 <- factor(data$Y2937801, 
                          levels=c(1.0,2.0,3.0,4.0,5.0), 
                          labels=c("Very Inaccurate",
                                   "Moderately Inaccurate",
                                   "Neither Accurate Nor Inaccurate",
                                   "Moderately Accurate",
                                   "Very Accurate"))
  data$Y2937802 <- factor(data$Y2937802, 
                          levels=c(1.0,2.0,3.0,4.0,5.0), 
                          labels=c("Very Inaccurate",
                                   "Moderately Inaccurate",
                                   "Neither Accurate Nor Inaccurate",
                                   "Moderately Accurate",
                                   "Very Accurate"))
  data$Y2937803 <- factor(data$Y2937803, 
                          levels=c(1.0,2.0,3.0,4.0,5.0), 
                          labels=c("Very Inaccurate",
                                   "Moderately Inaccurate",
                                   "Neither Accurate Nor Inaccurate",
                                   "Moderately Accurate",
                                   "Very Accurate"))
  data$Y2937804 <- factor(data$Y2937804, 
                          levels=c(1.0,2.0,3.0,4.0,5.0), 
                          labels=c("Very Inaccurate",
                                   "Moderately Inaccurate",
                                   "Neither Accurate Nor Inaccurate",
                                   "Moderately Accurate",
                                   "Very Accurate"))
  data$Y2937805 <- factor(data$Y2937805, 
                          levels=c(1.0,2.0,3.0,4.0,5.0), 
                          labels=c("Very Inaccurate",
                                   "Moderately Inaccurate",
                                   "Neither Accurate Nor Inaccurate",
                                   "Moderately Accurate",
                                   "Very Accurate"))
  data$Y2937806 <- factor(data$Y2937806, 
                          levels=c(1.0,2.0,3.0,4.0,5.0), 
                          labels=c("Very Inaccurate",
                                   "Moderately Inaccurate",
                                   "Neither Accurate Nor Inaccurate",
                                   "Moderately Accurate",
                                   "Very Accurate"))
  data$Y2937807 <- factor(data$Y2937807, 
                          levels=c(1.0,2.0,3.0,4.0,5.0), 
                          labels=c("Very Inaccurate",
                                   "Moderately Inaccurate",
                                   "Neither Accurate Nor Inaccurate",
                                   "Moderately Accurate",
                                   "Very Accurate"))
  data$Y2937808 <- factor(data$Y2937808, 
                          levels=c(1.0,2.0,3.0,4.0,5.0), 
                          labels=c("Very Inaccurate",
                                   "Moderately Inaccurate",
                                   "Neither Accurate Nor Inaccurate",
                                   "Moderately Accurate",
                                   "Very Accurate"))
  data$Y2937809 <- factor(data$Y2937809, 
                          levels=c(1.0,2.0,3.0,4.0,5.0), 
                          labels=c("Very Inaccurate",
                                   "Moderately Inaccurate",
                                   "Neither Accurate Nor Inaccurate",
                                   "Moderately Accurate",
                                   "Very Accurate"))
  data$Y2937810 <- factor(data$Y2937810, 
                          levels=c(1.0,2.0,3.0,4.0,5.0), 
                          labels=c("Very Inaccurate",
                                   "Moderately Inaccurate",
                                   "Neither Accurate Nor Inaccurate",
                                   "Moderately Accurate",
                                   "Very Accurate"))
  data$Y2937811 <- factor(data$Y2937811, 
                          levels=c(1.0,2.0,3.0,4.0,5.0), 
                          labels=c("Very Inaccurate",
                                   "Moderately Inaccurate",
                                   "Neither Accurate Nor Inaccurate",
                                   "Moderately Accurate",
                                   "Very Accurate"))
  data$Y2937812 <- factor(data$Y2937812, 
                          levels=c(1.0,2.0,3.0,4.0,5.0), 
                          labels=c("Very Inaccurate",
                                   "Moderately Inaccurate",
                                   "Neither Accurate Nor Inaccurate",
                                   "Moderately Accurate",
                                   "Very Accurate"))
  data$Y2937813 <- factor(data$Y2937813, 
                          levels=c(1.0,2.0,3.0,4.0,5.0), 
                          labels=c("Very Inaccurate",
                                   "Moderately Inaccurate",
                                   "Neither Accurate Nor Inaccurate",
                                   "Moderately Accurate",
                                   "Very Accurate"))
  data$Y2937814 <- factor(data$Y2937814, 
                          levels=c(1.0,2.0,3.0,4.0,5.0), 
                          labels=c("Very Inaccurate",
                                   "Moderately Inaccurate",
                                   "Neither Accurate Nor Inaccurate",
                                   "Moderately Accurate",
                                   "Very Accurate"))
  data$Y2937815 <- factor(data$Y2937815, 
                          levels=c(1.0,2.0,3.0,4.0,5.0), 
                          labels=c("Very Inaccurate",
                                   "Moderately Inaccurate",
                                   "Neither Accurate Nor Inaccurate",
                                   "Moderately Accurate",
                                   "Very Accurate"))
  data$Y2937816 <- factor(data$Y2937816, 
                          levels=c(1.0,2.0,3.0,4.0,5.0), 
                          labels=c("Very Inaccurate",
                                   "Moderately Inaccurate",
                                   "Neither Accurate Nor Inaccurate",
                                   "Moderately Accurate",
                                   "Very Accurate"))
  data$Y2937817 <- factor(data$Y2937817, 
                          levels=c(1.0,2.0,3.0,4.0,5.0), 
                          labels=c("Very Inaccurate",
                                   "Moderately Inaccurate",
                                   "Neither Accurate Nor Inaccurate",
                                   "Moderately Accurate",
                                   "Very Accurate"))
  data$Y2937818 <- factor(data$Y2937818, 
                          levels=c(1.0,2.0,3.0,4.0,5.0), 
                          labels=c("Very Inaccurate",
                                   "Moderately Inaccurate",
                                   "Neither Accurate Nor Inaccurate",
                                   "Moderately Accurate",
                                   "Very Accurate"))
  data$Y2937819 <- factor(data$Y2937819, 
                          levels=c(1.0,2.0,3.0,4.0,5.0), 
                          labels=c("Very Inaccurate",
                                   "Moderately Inaccurate",
                                   "Neither Accurate Nor Inaccurate",
                                   "Moderately Accurate",
                                   "Very Accurate"))
  data$Y3307400 <- factor(data$Y3307400, 
                          levels=c(0.0,1.0), 
                          labels=c("0: NA FOR SECOND RANDOMIZATION",
                                   "1: SELECTED FOR SECOND RANDOMIZATION"))
  data$Y3307500 <- factor(data$Y3307500, 
                          levels=c(0.0,1.0), 
                          labels=c("0: NA FOR THIRD RANDOMIZATION",
                                   "1: SELECTED FOR THIRD RANDOMIZATION"))
  data$Y3307600 <- factor(data$Y3307600, 
                          levels=c(0.0,1.0), 
                          labels=c("0: NA TO COMPLETE BOTH TIPI AND MINI-IPIP",
                                   "1: SELECTED TO COMPLETE BOTH TIPI AND MINI-IPIP"))
  data$Y3307700 <- factor(data$Y3307700, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y3307701 <- factor(data$Y3307701, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y3307702 <- factor(data$Y3307702, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y3307703 <- factor(data$Y3307703, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y3307704 <- factor(data$Y3307704, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y3307705 <- factor(data$Y3307705, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y3307706 <- factor(data$Y3307706, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y3307707 <- factor(data$Y3307707, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y3307708 <- factor(data$Y3307708, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y3307709 <- factor(data$Y3307709, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y3651700 <- factor(data$Y3651700, 
                          levels=c(0.0,1.0), 
                          labels=c("0: CONDITION DOES NOT APPLY",
                                   "1: CONDITION APPLIES"))
  data$Y3651800 <- factor(data$Y3651800, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y3651801 <- factor(data$Y3651801, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y3651802 <- factor(data$Y3651802, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y3651803 <- factor(data$Y3651803, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y3651804 <- factor(data$Y3651804, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y3651805 <- factor(data$Y3651805, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y3651806 <- factor(data$Y3651806, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y3651807 <- factor(data$Y3651807, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y3651808 <- factor(data$Y3651808, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y3651809 <- factor(data$Y3651809, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- Disagree strongly",
                                   "2 -- Disagree moderately",
                                   "3 -- Disagree a little",
                                   "4 -- Neither agree nor disagree",
                                   "5 -- Agree a little",
                                   "6 -- Agree moderately",
                                   "7 -- Agree strongly"))
  data$Y4259400 <- factor(data$Y4259400, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- DISAGREE STRONGLY",
                                   "2 -- DISAGREE MODERATELY",
                                   "3 -- DISAGREE A LITTLE",
                                   "4 -- NEITHER AGREE NOR DISAGREE",
                                   "5 -- AGREE A LITTLE",
                                   "6 -- AGREE MODERATELY",
                                   "7 -- AGREE STRONGLY"))
  data$Y4259401 <- factor(data$Y4259401, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- DISAGREE STRONGLY",
                                   "2 -- DISAGREE MODERATELY",
                                   "3 -- DISAGREE A LITTLE",
                                   "4 -- NEITHER AGREE NOR DISAGREE",
                                   "5 -- AGREE A LITTLE",
                                   "6 -- AGREE MODERATELY",
                                   "7 -- AGREE STRONGLY"))
  data$Y4259402 <- factor(data$Y4259402, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- DISAGREE STRONGLY",
                                   "2 -- DISAGREE MODERATELY",
                                   "3 -- DISAGREE A LITTLE",
                                   "4 -- NEITHER AGREE NOR DISAGREE",
                                   "5 -- AGREE A LITTLE",
                                   "6 -- AGREE MODERATELY",
                                   "7 -- AGREE STRONGLY"))
  data$Y4259403 <- factor(data$Y4259403, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- DISAGREE STRONGLY",
                                   "2 -- DISAGREE MODERATELY",
                                   "3 -- DISAGREE A LITTLE",
                                   "4 -- NEITHER AGREE NOR DISAGREE",
                                   "5 -- AGREE A LITTLE",
                                   "6 -- AGREE MODERATELY",
                                   "7 -- AGREE STRONGLY"))
  data$Y4259404 <- factor(data$Y4259404, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- DISAGREE STRONGLY",
                                   "2 -- DISAGREE MODERATELY",
                                   "3 -- DISAGREE A LITTLE",
                                   "4 -- NEITHER AGREE NOR DISAGREE",
                                   "5 -- AGREE A LITTLE",
                                   "6 -- AGREE MODERATELY",
                                   "7 -- AGREE STRONGLY"))
  data$Y4259405 <- factor(data$Y4259405, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- DISAGREE STRONGLY",
                                   "2 -- DISAGREE MODERATELY",
                                   "3 -- DISAGREE A LITTLE",
                                   "4 -- NEITHER AGREE NOR DISAGREE",
                                   "5 -- AGREE A LITTLE",
                                   "6 -- AGREE MODERATELY",
                                   "7 -- AGREE STRONGLY"))
  data$Y4259406 <- factor(data$Y4259406, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- DISAGREE STRONGLY",
                                   "2 -- DISAGREE MODERATELY",
                                   "3 -- DISAGREE A LITTLE",
                                   "4 -- NEITHER AGREE NOR DISAGREE",
                                   "5 -- AGREE A LITTLE",
                                   "6 -- AGREE MODERATELY",
                                   "7 -- AGREE STRONGLY"))
  data$Y4259407 <- factor(data$Y4259407, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- DISAGREE STRONGLY",
                                   "2 -- DISAGREE MODERATELY",
                                   "3 -- DISAGREE A LITTLE",
                                   "4 -- NEITHER AGREE NOR DISAGREE",
                                   "5 -- AGREE A LITTLE",
                                   "6 -- AGREE MODERATELY",
                                   "7 -- AGREE STRONGLY"))
  data$Y4259408 <- factor(data$Y4259408, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- DISAGREE STRONGLY",
                                   "2 -- DISAGREE MODERATELY",
                                   "3 -- DISAGREE A LITTLE",
                                   "4 -- NEITHER AGREE NOR DISAGREE",
                                   "5 -- AGREE A LITTLE",
                                   "6 -- AGREE MODERATELY",
                                   "7 -- AGREE STRONGLY"))
  data$Y4259409 <- factor(data$Y4259409, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
                          labels=c("1 -- DISAGREE STRONGLY",
                                   "2 -- DISAGREE MODERATELY",
                                   "3 -- DISAGREE A LITTLE",
                                   "4 -- NEITHER AGREE NOR DISAGREE",
                                   "5 -- AGREE A LITTLE",
                                   "6 -- AGREE MODERATELY",
                                   "7 -- AGREE STRONGLY"))
  return(data)
}

varlabels <- c("ID CODE OF CHILD",
               "ID CODE OF MOTHER OF CHILD",
               "RACE OF CHILD (FROM MOTHERS SCREENER 79)",
               "SEX OF CHILD",
               "DATE OF BIRTH OF CHILD - MONTH",
               "DATE OF BIRTH OF CHILD - YEAR",
               "CHILD EVER SUSPENDED FROM SCHOOL",
               "CHILDS GRADE WHEN SUSPENDED",
               "HAS CHILD EVER BEEN SUSPENDED/EXPELLED",
               "WHAT GRADE DID THIS HAPPEN",
               "HAS CH EVER BEEN SUSPENDED/EXPELLED?-92",
               "WHAT GRADE CH 1ST SUSPENDED/EXPELLED?-92",
               "MS CHILD EVER SUSPENDED/EXPELLED? 94",
               "MS WHEN DID SUSPEND/EXPEL 1ST HAPPEN 94",
               "MS CHILD EVER SUSPENDED/EXPELLED 96",
               "MS WHEN DID SUSPEND/EXPEL 1ST HAPPEN 96",
               "MS CHILD EVER SUSPENDED/EXPELLED 1998",
               "MS WHEN DID SUSPEND/EXPEL 1ST HAPPN 1998",
               "CHILD EVER SUSPENDED/EXPELLED 2000",
               "WHEN DID SUSPEND/EXPEL 1ST HAPPEN 2000",
               "CHILD EVER SUSPENDED/EXPELLED 2002",
               "WHEN DID SUSPEND/EXPEL 1ST HAPPEN 2002",
               "CHILD EVER SUSPENDED/EXPELLED 2004",
               "WHEN DID SUSPEND/EXPEL 1ST HAPPEN 2004",
               "CHILD EVER SUSPENDED/EXPELLED 2006",
               "WHEN DID SUSPEND/EXPEL 1ST HAPPEN 2006",
               "CHILD EVER SUSPENDED/EXPELLED 2008",
               "WHEN DID SUSPEND/EXPEL 1ST HAPPEN 2008",
               "CHILD EVER SUSPENDED/EXPELLED 2010",
               "WHEN DID SUSPEND/EXPEL 1ST HAPPEN 2010",
               "CHILD EVER SUSPENDED/EXPELLED 2012",
               "WHEN DID SUSPEND/EXPEL 1ST HAPPEN 2012",
               "CHILD EVER SUSPENDED/EXPELLED 2014",
               "WHEN DID SUSPEND/EXPEL 1ST HAPPEN 2014",
               "BRANCH ON GENDER OF R          94 1994",
               "WHEN HIGH GRADES SUFFERED             94 1994",
               "WHEN HIGH GRADES SUFFERED             96 1996",
               "WHEN HIGH GRADES SUFFERED 1998",
               "TIPI (HW APPLIES TO R) - EXTRAVERTED, ENTHUSIASTIC 2006",
               "TIPI (HW APPLIES TO R) - CRITICAL, QUARRLESOME 2006",
               "TIPI (HW APPLIES TO R) - DEPENDABLE, SELF-DISCIPLN 2006",
               "TIPI (HW APPLIES TO R) - ANXIOUS, EASILY UPSET 2006",
               "TIPI (HW APPLIES TO R) - OPEN TO NEW EXPER, COMPLX 2006",
               "TIPI (HW APPLIES TO R) - RESERVED, QUIET 2006",
               "TIPI (HW APPLIES TO R) - SYMPATHETIC, WARM 2006",
               "TIPI (HW APPLIES TO R) - DISORGANIZED, CARELESS 2006",
               "TIPI (HW APPLIES TO R) - CALM, EMOTIONALLY STABLE 2006",
               "TIPI (HW APPLIES TO R) - CONVENTIONAL, UNCREATIVE 2006",
               "TIPI (HW APPLIES TO R) - EXTRAVERTED, ENTHUSIASTIC 2008",
               "TIPI (HW APPLIES TO R) - CRITICAL, QUARRLESOME 2008",
               "TIPI (HW APPLIES TO R) - DEPENDABLE, SELF-DISCIPLN 2008",
               "TIPI (HW APPLIES TO R) - ANXIOUS, EASILY UPSET 2008",
               "TIPI (HW APPLIES TO R) - OPEN TO NEW EXPER, COMPLX 2008",
               "TIPI (HW APPLIES TO R) - RESERVED, QUIET 2008",
               "TIPI (HW APPLIES TO R) - SYMPATHETIC, WARM 2008",
               "TIPI (HW APPLIES TO R) - DISORGANIZED, CARELESS 2008",
               "TIPI (HW APPLIES TO R) - CALM, EMOTIONALLY STABLE 2008",
               "TIPI (HW APPLIES TO R) - CONVENTIONAL, UNCREATIVE 2008",
               "VERSION_R28 CHILD/YOUNG ADULT XRND",
               "TIPI (HW APPLIES TO R) - EXTRAVERTED, ENTHUSIASTIC 2010",
               "TIPI (HW APPLIES TO R) - CRITICAL, QUARRLESOME 2010",
               "TIPI (HW APPLIES TO R) - DEPENDABLE, SELF-DISCIPLN 2010",
               "TIPI (HW APPLIES TO R) - ANXIOUS, EASILY UPSET 2010",
               "TIPI (HW APPLIES TO R) - OPEN TO NEW EXPER, COMPLX 2010",
               "TIPI (HW APPLIES TO R) - RESERVED, QUIET 2010",
               "TIPI (HW APPLIES TO R) - SYMPATHETIC, WARM 2010",
               "TIPI (HW APPLIES TO R) - DISORGANIZED, CARELESS 2010",
               "TIPI (HW APPLIES TO R) - CALM, EMOTIONALLY STABLE 2010",
               "TIPI (HW APPLIES TO R) - CONVENTIONAL, UNCREATIVE 2010",
               "CHECK:  R INT AS YA IN 10 2012",
               "1ST FLAG FOR RAND YAS INTV 2010 FOR TIPI/MINI-IPIP 2012",
               "2ND FLAG FOR RAND YAS INTV 2010 FOR TIPI/MINI-IPIP 2012",
               "1ST FLAG FOR RAND YAS NONINT 2010 TIPI/MINI-IPIP 2012",
               "2ND FLAG FOR RAND YAS NONINT 2010 TIPI/MINI-IPIP 2012",
               "TIPI (HW APPLIES TO R) - EXTRAVERTED, ENTHUSIASTIC 2012",
               "TIPI (HW APPLIES TO R) - CRITICAL, QUARRLESOME 2012",
               "TIPI (HW APPLIES TO R) - DEPENDABLE, SELF-DISCIPLN 2012",
               "TIPI (HW APPLIES TO R) - ANXIOUS, EASILY UPSET 2012",
               "TIPI (HW APPLIES TO R) - OPEN TO NEW EXPER, COMPLX 2012",
               "TIPI (HW APPLIES TO R) - RESERVED, QUIET 2012",
               "TIPI (HW APPLIES TO R) - SYMPATHETIC, WARM 2012",
               "TIPI (HW APPLIES TO R) - DISORGANIZED, CARELESS 2012",
               "TIPI (HW APPLIES TO R) - CALM, EMOTIONALLY STABLE 2012",
               "TIPI (HW APPLIES TO R) - CONVENTIONAL, UNCREATIVE 2012",
               "MINI-IPIP (HW ACCU DESC R) - I AM LIFE OF PARTY 2012",
               "MINI-IPIP (HW ACCU DESC R) - I SYMP W/ OTH FEELNGS 2012",
               "MINI-IPIP (HW ACCU DESC R) - GET CHORES DN RT AWAY 2012",
               "MINI-IPIP (HW ACCU DESC R) - I HV FREQ MOOD SWINGS 2012",
               "MINI-IPIP (HW ACCU DESC R) - HV A VIVID IMAGINATN 2012",
               "MINI-IPIP (HW ACCU DESC R) - I DONT TALK A LOT 2012",
               "MINI-IPIP (HW AC DESC R) - NOT INT IN OTH PPL PROB 2012",
               "MINI-IPIP (HW DESC R) -  FORGET TO PUT THINGS BACK 2012",
               "MINI-IPIP (HW ACCU DESC R) - RELAXED MOST OF TIME 2012",
               "MINI-IPIP (HW ACCU DESC R) - NOT INT IN ABST IDEAS 2012",
               "MINI-IPIP (HW DESC R) - TLK TO MANY PPL AT PARTIES 2012",
               "MINI-IPIP (HW DESC R) - I FEEL OTHERS EMOTIONS 2012",
               "MINI-IPIP (HW ACCU DESC R) - I LIKE ORDER 2012",
               "MINI-IPIP (HW ACCU DESC R) - I GET UPSET EASILY 2012",
               "MINI-IPIP (HW ACCU DESC R) - DIFF UNDERST AB IDEAS 2012",
               "MINI-IPIP (HW ACCU DESC R) - I KEEP IN BACKGROUND 2012",
               "MINI-IPIP (HW DESC R) - NOT REALLY INTEREST IN OTH 2012",
               "MINI-IPIP (HW AC DESC R) - I MAKE A MESS OF THINGS 2012",
               "MINI-IPIP (HW ACCU DESC R) - SELDOM FEEL BLUE 2012",
               "MINI-IPIP (HW DESC R) - DO NOT HV A GD IMAGINATION 2012",
               "1ST FLAG FOR RAND SUBSET OF RS FOR TIPI/MINI-IPIP 2014",
               "2ND FLAG FOR RAND SUBSET OF RS FOR TIPI/MINI-IPIP 2014",
               "3RD  FLAG FOR RAND SUBSET OF RS FOR TIPI/MINI-IPIP 2014",
               "TIPI (HW APPLIES TO R) - EXTRAVERTED, ENTHUSIASTIC 2014",
               "TIPI (HW APPLIES TO R) - CRITICAL, QUARRLESOME 2014",
               "TIPI (HW APPLIES TO R) - DEPENDABLE, SELF-DISCIPLN 2014",
               "TIPI (HW APPLIES TO R) - ANXIOUS, EASILY UPSET 2014",
               "TIPI (HW APPLIES TO R) - OPEN TO NEW EXPER, COMPLX 2014",
               "TIPI (HW APPLIES TO R) - RESERVED, QUIET 2014",
               "TIPI (HW APPLIES TO R) - SYMPATHETIC, WARM 2014",
               "TIPI (HW APPLIES TO R) - DISORGANIZED, CARELESS 2014",
               "TIPI (HW APPLIES TO R) - CALM, EMOTIONALLY STABLE 2014",
               "TIPI (HW APPLIES TO R) - CONVENTIONAL, UNCREATIVE 2014",
               "CHECK:  R INT AS YA IN 14 2016",
               "TIPI (HW APPLIES TO R) - EXTRAVERTED, ENTHUSIASTIC 2016",
               "TIPI (HW APPLIES TO R) - CRITICAL, QUARRLESOME 2016",
               "TIPI (HW APPLIES TO R) - DEPENDABLE, SELF-DISCIPLN 2016",
               "TIPI (HW APPLIES TO R) - ANXIOUS, EASILY UPSET 2016",
               "TIPI (HW APPLIES TO R) - OPEN TO NEW EXPER, COMPLX 2016",
               "TIPI (HW APPLIES TO R) - RESERVED, QUIET 2016",
               "TIPI (HW APPLIES TO R) - SYMPATHETIC, WARM 2016",
               "TIPI (HW APPLIES TO R) - DISORGANIZED, CARELESS 2016",
               "TIPI (HW APPLIES TO R) - CALM, EMOTIONALLY STABLE 2016",
               "TIPI (HW APPLIES TO R) - CONVENTIONAL, UNCREATIVE 2016",
               "TIPI (HW APPLIES TO R) - EXTRAVERTED, ENTHUSIASTIC 2018",
               "TIPI (HW APPLIES TO R) - CRITICAL, QUARRLESOME 2018",
               "TIPI (HW APPLIES TO R) - DEPENDABLE, SELF-DISCIPLN 2018",
               "TIPI (HW APPLIES TO R) - ANXIOUS, EASILY UPSET 2018",
               "TIPI (HW APPLIES TO R) - OPEN TO NEW EXPER, COMPLX 2018",
               "TIPI (HW APPLIES TO R) - RESERVED, QUIET 2018",
               "TIPI (HW APPLIES TO R) - SYMPATHETIC, WARM 2018",
               "TIPI (HW APPLIES TO R) - DISORGANIZED, CARELESS 2018",
               "TIPI (HW APPLIES TO R) - CALM, EMOTIONALLY STABLE 2018",
               "TIPI (HW APPLIES TO R) - CONVENTIONAL, UNCREATIVE 2018"
)


# Use qnames rather than rnums

qnames = function(data) {
  names(data) <- c("pid",
                   "MPUBID_XRND",
                   "race",
                   "sex",
                   "month",
                   "year",
                   "ever_1988",
                   "grade_1988",
                   "ever_1990",
                   "grade_1990",
                   "ever_1992",
                   "grade_1992",
                   "ever_1994",
                   "grade_1994",
                   "ever_1996",
                   "grade_1996",
                   "ever_1998",
                   "grade_1998",
                   "ever_2000",
                   "grade_2000",
                   "ever_2002",
                   "grade_2002",
                   "ever_2004",
                   "grade_2004",
                   "ever_2006",
                   "grade_2006",
                   "ever_2008",
                   "grade_2008",
                   "ever_2010",
                   "grade_2010",
                   "ever_2012",
                   "grade_2012",
                   "ever_2014",
                   "grade_2014",
                   "machine_sex",
                   "high1",
                   "high2",
                   "high3",
                   "Q16-9~000001_2006",
                   "Q16-9~000002_2006",
                   "Q16-9~000003_2006",
                   "Q16-9~000004_2006",
                   "Q16-9~000005_2006",
                   "Q16-9~000006_2006",
                   "Q16-9~000007_2006",
                   "Q16-9~000008_2006",
                   "Q16-9~000009_2006",
                   "Q16-9~000010_2006",
                   "Q16-9~000001_2008",
                   "Q16-9~000002_2008",
                   "Q16-9~000003_2008",
                   "Q16-9~000004_2008",
                   "Q16-9~000005_2008",
                   "Q16-9~000006_2008",
                   "Q16-9~000007_2008",
                   "Q16-9~000008_2008",
                   "Q16-9~000009_2008",
                   "Q16-9~000010_2008",
                   "VERSION_R28_XRND",
                   "Q16-9~000001_2010",
                   "Q16-9~000002_2010",
                   "Q16-9~000003_2010",
                   "Q16-9~000004_2010",
                   "Q16-9~000005_2010",
                   "Q16-9~000006_2010",
                   "Q16-9~000007_2010",
                   "Q16-9~000008_2010",
                   "Q16-9~000009_2010",
                   "Q16-9~000010_2010",
                   "Q16-8G_2012",
                   "Q16-8GB_2012",
                   "Q16-8GD_2012",
                   "Q16-8GG_2012",
                   "Q16-8GI_2012",
                   "Q16-9~000001_2012",
                   "Q16-9~000002_2012",
                   "Q16-9~000003_2012",
                   "Q16-9~000004_2012",
                   "Q16-9~000005_2012",
                   "Q16-9~000006_2012",
                   "Q16-9~000007_2012",
                   "Q16-9~000008_2012",
                   "Q16-9~000009_2012",
                   "Q16-9~000010_2012",
                   "Q16-9A~000001_2012",
                   "Q16-9A~000002_2012",
                   "Q16-9A~000003_2012",
                   "Q16-9A~000004_2012",
                   "Q16-9A~000005_2012",
                   "Q16-9A~000006_2012",
                   "Q16-9A~000007_2012",
                   "Q16-9A~000008_2012",
                   "Q16-9A~000009_2012",
                   "Q16-9A~000010_2012",
                   "Q16-9A~000011_2012",
                   "Q16-9A~000012_2012",
                   "Q16-9A~000013_2012",
                   "Q16-9A~000014_2012",
                   "Q16-9A~000015_2012",
                   "Q16-9A~000016_2012",
                   "Q16-9A~000017_2012",
                   "Q16-9A~000018_2012",
                   "Q16-9A~000019_2012",
                   "Q16-9A~000020_2012",
                   "Q16-8GB_2014",
                   "Q16-8GD_2014",
                   "Q16-8GDA_2014",
                   "Q16-9~000001_2014",
                   "Q16-9~000002_2014",
                   "Q16-9~000003_2014",
                   "Q16-9~000004_2014",
                   "Q16-9~000005_2014",
                   "Q16-9~000006_2014",
                   "Q16-9~000007_2014",
                   "Q16-9~000008_2014",
                   "Q16-9~000009_2014",
                   "Q16-9~000010_2014",
                   "Q16-8G_2016",
                   "Q16-9~000001_2016",
                   "Q16-9~000002_2016",
                   "Q16-9~000003_2016",
                   "Q16-9~000004_2016",
                   "Q16-9~000005_2016",
                   "Q16-9~000006_2016",
                   "Q16-9~000007_2016",
                   "Q16-9~000008_2016",
                   "Q16-9~000009_2016",
                   "Q16-9~000010_2016",
                   "Q16-9~000001_2018",
                   "Q16-9~000002_2018",
                   "Q16-9~000003_2018",
                   "Q16-9~000004_2018",
                   "Q16-9~000005_2018",
                   "Q16-9~000006_2018",
                   "Q16-9~000007_2018",
                   "Q16-9~000008_2018",
                   "Q16-9~000009_2018",
                   "Q16-9~000010_2018")
  return(data)
}



names_from_cleaning_functions <- c('C0000100',
  'C0000200',
  'C0005300',
  'C0005400',
  'C0005500',
  'C0005700',
  'C0785700',
  'C0785800',
  'C0988400',
  'C0988500',
  'C1186700',
  'C1186800',
  'C1440400',
  'C1440500',
  'C1642800',
  'C1642900',
  'C1983200',
  'C1983300',
  'C2251400',
  'C2251500',
  'C2735000',
  'C2735100',
  'C3007400',
  'C3007500',
  'C3577600',
  'C3577700',
  'C3950100',
  'C3950200',
  'C5194200',
  'C5194300',
  'C5769100',
  'C5769200',
  'C6035900',
  'C6036000',
  'Y0307300',
  'Y0367000',
  'Y0661000',
  'Y0957900',
  'Y1921300',
  'Y1921301',
  'Y1921302',
  'Y1921303',
  'Y1921304',
  'Y1921305',
  'Y1921306',
  'Y1921307',
  'Y1921308',
  'Y1921309',
  'Y2238200',
  'Y2238201',
  'Y2238202',
  'Y2238203',
  'Y2238204',
  'Y2238205',
  'Y2238206',
  'Y2238207',
  'Y2238208',
  'Y2238209',
  'Y2267000',
  'Y2590300',
  'Y2590301',
  'Y2590302',
  'Y2590303',
  'Y2590304',
  'Y2590305',
  'Y2590306',
  'Y2590307',
  'Y2590308',
  'Y2590309',
  'Y2937100',
  'Y2937200',
  'Y2937300',
  'Y2937400',
  'Y2937500',
  'Y2937600',
  'Y2937601',
  'Y2937602',
  'Y2937603',
  'Y2937604',
  'Y2937605',
  'Y2937606',
  'Y2937607',
  'Y2937608',
  'Y2937609',
  'Y2937800',
  'Y2937801',
  'Y2937802',
  'Y2937803',
  'Y2937804',
  'Y2937805',
  'Y2937806',
  'Y2937807',
  'Y2937808',
  'Y2937809',
  'Y2937810',
  'Y2937811',
  'Y2937812',
  'Y2937813',
  'Y2937814',
  'Y2937815',
  'Y2937816',
  'Y2937817',
  'Y2937818',
  'Y2937819',
  'Y3307400',
  'Y3307500',
  'Y3307600',
  'Y3307700',
  'Y3307701',
  'Y3307702',
  'Y3307703',
  'Y3307704',
  'Y3307705',
  'Y3307706',
  'Y3307707',
  'Y3307708',
  'Y3307709',
  'Y3651700',
  'Y3651800',
  'Y3651801',
  'Y3651802',
  'Y3651803',
  'Y3651804',
  'Y3651805',
  'Y3651806',
  'Y3651807',
  'Y3651808',
  'Y3651809',
  'Y4259400',
  'Y4259401',
  'Y4259402',
  'Y4259403',
  'Y4259404',
  'Y4259405',
  'Y4259406',
  'Y4259407',
  'Y4259408',
  'Y4259409')


race_new_data_names <- c('C0000100','C0000200','C0005400','C0005700','Y0009800','Y0396800','Y0686600',
                         'Y0992300','Y0992301','Y0992302','Y0992303','Y0992304','Y0992305','Y1232900',
                         'Y1232901','Y1232902','Y1232903','Y1232904','Y1232905','Y1462700','Y1462701',
                         'Y1462702','Y1462703','Y1462704','Y1462705','Y1709900','Y1709901','Y1709902',
                         'Y1709903','Y1709904','Y1709905','Y1995500','Y1995501','Y1995502','Y1995503',
                         'Y1995504','Y1995505','Y1995506','Y2267000','Y2314300','Y2314301','Y2314302',
                         'Y2314303','Y2314304','Y2314305','Y2314306','Y2647000','Y2647001','Y2647002',
                         'Y2647003','Y2647004','Y2647005','Y2647006','Y3004200','Y3004201','Y3004202',
                         'Y3004203','Y3004204','Y3004205','Y3004206','Y3373000','Y3373001','Y3373002',
                         'Y3373003','Y3373004','Y3373005','Y3373006','Y4014100','Y4014101','Y4014102',
                         'Y4014103','Y4014104','Y4014105','Y4014106')

vallabels_race = function(data) {
  data$C0000100[1.0 <= data$C0000100 & data$C0000100 <= 9999999.0] <- 1.0
  data$C0000100 <- factor(data$C0000100, 
                          levels=c(1.0), 
                          labels=c("1 TO 9999999: See Min & Max values below for range as of this release"))
  data$C0000200[1.0 <= data$C0000200 & data$C0000200 <= 12686.0] <- 1.0
  data$C0000200 <- factor(data$C0000200, 
                          levels=c(1.0), 
                          labels=c("1 TO 12686: NLSY79 Public ID"))
  data$C0005400 <- factor(data$C0005400, 
                          levels=c(1.0,2.0), 
                          labels=c("MALE",
                                   "FEMALE"))
  data$C0005700[1970.0 <= data$C0005700 & data$C0005700 <= 1978.0] <- 1970.0
  data$C0005700 <- factor(data$C0005700, 
                          levels=c(1970.0,1979.0,1980.0,1981.0,1982.0,1983.0,1984.0,1985.0,1986.0,1987.0,1988.0,1989.0,1990.0,1991.0,1992.0,1993.0,1994.0,1995.0,1996.0,1997.0,1998.0,1999.0,2000.0,2001.0,2002.0,2003.0,2004.0,2005.0,2006.0,2007.0,2008.0,2009.0,2010.0,2011.0,2012.0,2013.0,2014.0,2015.0,2016.0,2017.0,2018.0,2019.0), 
                          labels=c("1970 TO 1978: < before 1979",
                                   "1979",
                                   "1980",
                                   "1981",
                                   "1982",
                                   "1983",
                                   "1984",
                                   "1985",
                                   "1986",
                                   "1987",
                                   "1988",
                                   "1989",
                                   "1990",
                                   "1991",
                                   "1992",
                                   "1993",
                                   "1994",
                                   "1995",
                                   "1996",
                                   "1997",
                                   "1998",
                                   "1999",
                                   "2000",
                                   "2001",
                                   "2002",
                                   "2003",
                                   "2004",
                                   "2005",
                                   "2006",
                                   "2007",
                                   "2008",
                                   "2009",
                                   "2010",
                                   "2011",
                                   "2012",
                                   "2013",
                                   "2014",
                                   "2015",
                                   "2016",
                                   "2017",
                                   "2018",
                                   "2019"))
  data$Y0009800 <- factor(data$Y0009800, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0), 
                          labels=c("Black",
                                   "White (non-Hispanic)",
                                   "Hispanic",
                                   "American Indian",
                                   "Asian or Pacific Islander",
                                   "Other (SPECIFY)"))
  data$Y0396800 <- factor(data$Y0396800, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0), 
                          labels=c("Black",
                                   "White (non-Hispanic)",
                                   "Hispanic",
                                   "American Indian",
                                   "Asian or Pacific Islander",
                                   "Other (SPECIFY)"))
  data$Y0686600 <- factor(data$Y0686600, 
                          levels=c(1.0,2.0,3.0,4.0,5.0,6.0), 
                          labels=c("White",
                                   "black",
                                   "indig",
                                   "Asian",
                                   "api",
                                   "Other (SPECIFY)"))
  data$Y0992300 <- factor(data$Y0992300, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "White"))
  data$Y0992301[1.0 <= data$Y0992301 & data$Y0992301 <= 2.0] <- 1.0
  data$Y0992301 <- factor(data$Y0992301, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "black"))
  data$Y0992302[1.0 <= data$Y0992302 & data$Y0992302 <= 3.0] <- 1.0
  data$Y0992302 <- factor(data$Y0992302, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "indig"))
  data$Y0992303[1.0 <= data$Y0992303 & data$Y0992303 <= 4.0] <- 1.0
  data$Y0992303 <- factor(data$Y0992303, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "Asian"))
  data$Y0992304[1.0 <= data$Y0992304 & data$Y0992304 <= 5.0] <- 1.0
  data$Y0992304 <- factor(data$Y0992304, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "api"))
  data$Y0992305[1.0 <= data$Y0992305 & data$Y0992305 <= 6.0] <- 1.0
  data$Y0992305 <- factor(data$Y0992305, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "Other"))
  data$Y1232900 <- factor(data$Y1232900, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "White"))
  data$Y1232901[1.0 <= data$Y1232901 & data$Y1232901 <= 2.0] <- 1.0
  data$Y1232901 <- factor(data$Y1232901, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "black"))
  data$Y1232902[1.0 <= data$Y1232902 & data$Y1232902 <= 3.0] <- 1.0
  data$Y1232902 <- factor(data$Y1232902, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "indig"))
  data$Y1232903[1.0 <= data$Y1232903 & data$Y1232903 <= 4.0] <- 1.0
  data$Y1232903 <- factor(data$Y1232903, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "Asian"))
  data$Y1232904[1.0 <= data$Y1232904 & data$Y1232904 <= 5.0] <- 1.0
  data$Y1232904 <- factor(data$Y1232904, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "api"))
  data$Y1232905[1.0 <= data$Y1232905 & data$Y1232905 <= 6.0] <- 1.0
  data$Y1232905 <- factor(data$Y1232905, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "Other"))
  data$Y1462700 <- factor(data$Y1462700, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "White"))
  data$Y1462701[1.0 <= data$Y1462701 & data$Y1462701 <= 2.0] <- 1.0
  data$Y1462701 <- factor(data$Y1462701, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "black"))
  data$Y1462702[1.0 <= data$Y1462702 & data$Y1462702 <= 3.0] <- 1.0
  data$Y1462702 <- factor(data$Y1462702, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "indig"))
  data$Y1462703[1.0 <= data$Y1462703 & data$Y1462703 <= 4.0] <- 1.0
  data$Y1462703 <- factor(data$Y1462703, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "Asian"))
  data$Y1462704[1.0 <= data$Y1462704 & data$Y1462704 <= 5.0] <- 1.0
  data$Y1462704 <- factor(data$Y1462704, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "api"))
  data$Y1462705[1.0 <= data$Y1462705 & data$Y1462705 <= 6.0] <- 1.0
  data$Y1462705 <- factor(data$Y1462705, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "Other"))
  data$Y1709900 <- factor(data$Y1709900, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "White"))
  data$Y1709901[1.0 <= data$Y1709901 & data$Y1709901 <= 2.0] <- 1.0
  data$Y1709901 <- factor(data$Y1709901, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "black"))
  data$Y1709902[1.0 <= data$Y1709902 & data$Y1709902 <= 3.0] <- 1.0
  data$Y1709902 <- factor(data$Y1709902, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "indig"))
  data$Y1709903[1.0 <= data$Y1709903 & data$Y1709903 <= 4.0] <- 1.0
  data$Y1709903 <- factor(data$Y1709903, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "Asian"))
  data$Y1709904[1.0 <= data$Y1709904 & data$Y1709904 <= 5.0] <- 1.0
  data$Y1709904 <- factor(data$Y1709904, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "api"))
  data$Y1709905[1.0 <= data$Y1709905 & data$Y1709905 <= 6.0] <- 1.0
  data$Y1709905 <- factor(data$Y1709905, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "Other"))
  data$Y1995500 <- factor(data$Y1995500, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "White"))
  data$Y1995501[1.0 <= data$Y1995501 & data$Y1995501 <= 2.0] <- 1.0
  data$Y1995501 <- factor(data$Y1995501, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "black"))
  data$Y1995502[1.0 <= data$Y1995502 & data$Y1995502 <= 4.0] <- 1.0
  data$Y1995502 <- factor(data$Y1995502, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "Asian"))
  data$Y1995503[1.0 <= data$Y1995503 & data$Y1995503 <= 5.0] <- 1.0
  data$Y1995503 <- factor(data$Y1995503, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "api"))
  data$Y1995504[1.0 <= data$Y1995504 & data$Y1995504 <= 3.0] <- 1.0
  data$Y1995504 <- factor(data$Y1995504, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "indig"))
  data$Y1995505[1.0 <= data$Y1995505 & data$Y1995505 <= 6.0] <- 1.0
  data$Y1995505 <- factor(data$Y1995505, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "other"))
  data$Y1995506[1.0 <= data$Y1995506 & data$Y1995506 <= 7.0] <- 1.0
  data$Y1995506 <- factor(data$Y1995506, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "latinx"))
  data$Y2267000 <- factor(data$Y2267000, 
                          levels=c(506.0), 
                          labels=c("506"))
  data$Y2314300 <- factor(data$Y2314300, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "White"))
  data$Y2314301[1.0 <= data$Y2314301 & data$Y2314301 <= 2.0] <- 1.0
  data$Y2314301 <- factor(data$Y2314301, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "black"))
  data$Y2314302[1.0 <= data$Y2314302 & data$Y2314302 <= 3.0] <- 1.0
  data$Y2314302 <- factor(data$Y2314302, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "Asian"))
  data$Y2314303[1.0 <= data$Y2314303 & data$Y2314303 <= 4.0] <- 1.0
  data$Y2314303 <- factor(data$Y2314303, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "api"))
  data$Y2314304[1.0 <= data$Y2314304 & data$Y2314304 <= 5.0] <- 1.0
  data$Y2314304 <- factor(data$Y2314304, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "indig"))
  data$Y2314305[1.0 <= data$Y2314305 & data$Y2314305 <= 6.0] <- 1.0
  data$Y2314305 <- factor(data$Y2314305, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "other"))
  data$Y2314306[1.0 <= data$Y2314306 & data$Y2314306 <= 7.0] <- 1.0
  data$Y2314306 <- factor(data$Y2314306, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "latinx"))
  data$Y2647000 <- factor(data$Y2647000, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "White"))
  data$Y2647001[1.0 <= data$Y2647001 & data$Y2647001 <= 2.0] <- 1.0
  data$Y2647001 <- factor(data$Y2647001, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "black"))
  data$Y2647002[1.0 <= data$Y2647002 & data$Y2647002 <= 3.0] <- 1.0
  data$Y2647002 <- factor(data$Y2647002, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "Asian"))
  data$Y2647003[1.0 <= data$Y2647003 & data$Y2647003 <= 4.0] <- 1.0
  data$Y2647003 <- factor(data$Y2647003, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "api"))
  data$Y2647004[1.0 <= data$Y2647004 & data$Y2647004 <= 5.0] <- 1.0
  data$Y2647004 <- factor(data$Y2647004, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "indig"))
  data$Y2647005[1.0 <= data$Y2647005 & data$Y2647005 <= 6.0] <- 1.0
  data$Y2647005 <- factor(data$Y2647005, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "other"))
  data$Y2647006[1.0 <= data$Y2647006 & data$Y2647006 <= 7.0] <- 1.0
  data$Y2647006 <- factor(data$Y2647006, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "latinx"))
  data$Y3004200 <- factor(data$Y3004200, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "White"))
  data$Y3004201[1.0 <= data$Y3004201 & data$Y3004201 <= 2.0] <- 1.0
  data$Y3004201 <- factor(data$Y3004201, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "black"))
  data$Y3004202[1.0 <= data$Y3004202 & data$Y3004202 <= 3.0] <- 1.0
  data$Y3004202 <- factor(data$Y3004202, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "Asian"))
  data$Y3004203[1.0 <= data$Y3004203 & data$Y3004203 <= 4.0] <- 1.0
  data$Y3004203 <- factor(data$Y3004203, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "api"))
  data$Y3004204[1.0 <= data$Y3004204 & data$Y3004204 <= 5.0] <- 1.0
  data$Y3004204 <- factor(data$Y3004204, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "indig"))
  data$Y3004205[1.0 <= data$Y3004205 & data$Y3004205 <= 6.0] <- 1.0
  data$Y3004205 <- factor(data$Y3004205, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "other"))
  data$Y3004206[1.0 <= data$Y3004206 & data$Y3004206 <= 7.0] <- 1.0
  data$Y3004206 <- factor(data$Y3004206, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "latinx"))
  data$Y3373000 <- factor(data$Y3373000, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "White"))
  data$Y3373001[1.0 <= data$Y3373001 & data$Y3373001 <= 2.0] <- 1.0
  data$Y3373001 <- factor(data$Y3373001, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "black"))
  data$Y3373002[1.0 <= data$Y3373002 & data$Y3373002 <= 3.0] <- 1.0
  data$Y3373002 <- factor(data$Y3373002, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "Asian"))
  data$Y3373003[1.0 <= data$Y3373003 & data$Y3373003 <= 4.0] <- 1.0
  data$Y3373003 <- factor(data$Y3373003, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "api"))
  data$Y3373004[1.0 <= data$Y3373004 & data$Y3373004 <= 5.0] <- 1.0
  data$Y3373004 <- factor(data$Y3373004, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "indig"))
  data$Y3373005[1.0 <= data$Y3373005 & data$Y3373005 <= 6.0] <- 1.0
  data$Y3373005 <- factor(data$Y3373005, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "other"))
  data$Y3373006[1.0 <= data$Y3373006 & data$Y3373006 <= 7.0] <- 1.0
  data$Y3373006 <- factor(data$Y3373006, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "latinx"))
  data$Y4014100 <- factor(data$Y4014100, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "White"))
  data$Y4014101[1.0 <= data$Y4014101 & data$Y4014101 <= 2.0] <- 1.0
  data$Y4014101 <- factor(data$Y4014101, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "black"))
  data$Y4014102[1.0 <= data$Y4014102 & data$Y4014102 <= 3.0] <- 1.0
  data$Y4014102 <- factor(data$Y4014102, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "Asian"))
  data$Y4014103[1.0 <= data$Y4014103 & data$Y4014103 <= 4.0] <- 1.0
  data$Y4014103 <- factor(data$Y4014103, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "api"))
  data$Y4014104[1.0 <= data$Y4014104 & data$Y4014104 <= 5.0] <- 1.0
  data$Y4014104 <- factor(data$Y4014104, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "indig"))
  data$Y4014105[1.0 <= data$Y4014105 & data$Y4014105 <= 6.0] <- 1.0
  data$Y4014105 <- factor(data$Y4014105, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "other"))
  data$Y4014106[1.0 <= data$Y4014106 & data$Y4014106 <= 7.0] <- 1.0
  data$Y4014106 <- factor(data$Y4014106, 
                          levels=c(0.0,1.0), 
                          labels=c("NA",
                                   "latinx"))
  return(data)
}
nr_names <- c("pid",
              "ID CODE OF MOTHER OF CHILD",
              "SEX",
              "DATE OF BIRTH",
              "1994",
              "1996",
              "1998",
              "WHITE 2000",
              "BLACK OR AFRICAN AMER 2000",
              "AM INDIAN OR ALASKA NAT 2000",
              "ASIAN 2000",
              "NAT HAWAIIAN, OTH PAC IS 2000",
              "OTHER RACE (SPECIFY) 2000",
              "WHITE 2002",
              "BLACK OR AFRICAN AMER 2002",
              "AM INDIAN OR ALASKA NAT 2002",
              "ASIAN 2002",
              "NAT HAWAIIAN, OTH PAC IS 2002",
              "OTHER RACE (SPECIFY) 2002",
              "WHITE 2004",
              "BLACK OR AFRICAN AMER 2004",
              "AM INDIAN OR ALASKA NAT 2004",
              "ASIAN 2004",
              "NAT HAWAIIAN, OTH PAC IS 2004",
              "OTHER RACE (SPECIFY) 2004",
              "WHITE 2006",
              "BLACK OR AFRICAN AMER 2006",
              "AM INDIAN OR ALASKA NAT 2006",
              "ASIAN 2006",
              "NAT HAWAIIAN, OTH PAC IS 2006",
              "OTHER RACE (SPECIFY) 2006",
              "WHITE 2008",
              "BLACK OR AFRICAN AMER 2008",
              "ASIAN 2008",
              "NAT HAWAIIAN, OTH PAC IS 2008",
              "AM INDIAN OR ALASKA NAT 2008",
              "OTHER RACE (SPECIFY) 2008",
              "HISPANIC/LATINO 2008",
              "VERSION_R28 CHILD/YOUNG ADULT XRND",
              "WHITE 2010",
              "BLACK OR AFRICAN AMER 2010",
              "ASIAN 2010",
              "NAT HAWAIIAN, OTH PAC IS 2010",
              "AM INDIAN OR ALASKA NAT 2010",
              "OTHER RACE (SPECIFY) 2010",
              "HISPANIC/LATINO 2010",
              "WHITE 2012",
              "BLACK OR AFRICAN AMER 2012",
              "ASIAN 2012",
              "NAT HAWAIIAN, OTH PAC IS 2012",
              "AM INDIAN OR ALASKA NAT 2012",
              "OTHER RACE (SPECIFY) 2012",
              "HISPANIC/LATINO 2012",
              "WHITE 2014",
              "BLACK OR AFRICAN AMER 2014",
              "ASIAN 2014",
              "NAT HAWAIIAN, OTH PAC IS 2014",
              "AM INDIAN OR ALASKA NAT 2014",
              "OTHER RACE (SPECIFY) 2014",
              "HISPANIC/LATINO 2014",
              "WHITE 2016",
              "BLACK OR AFRICAN AMER 2016",
              "ASIAN 2016",
              "NAT HAWAIIAN, OTH PAC IS 2016",
              "AM INDIAN OR ALASKA NAT 2016",
              "OTHER RACE (SPECIFY) 2016",
              "HISPANIC/LATINO 2016",
              "WHITE 2018",
              "BLACK OR AFRICAN AMER 2018",
              "ASIAN 2018",
              "NAT HAWAIIAN, OTH PAC IS 2018",
              "AM INDIAN OR ALASKA NAT 2018",
              "OTHER RACE (SPECIFY) 2018",
              "HISPANIC/LATINO 2018"
)

